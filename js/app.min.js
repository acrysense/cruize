"use strict";

document.addEventListener('DOMContentLoaded', function () {
  // function's
  function bodyFixScroll(status) {
    var scrollPosition = 0;
    var paddingOffset = window.innerWidth - document.body.offsetWidth + 'px';
    var elementsFixed = document.querySelectorAll('.fixed');
    if (status) {
      document.body.classList.add('scroll-disabled');
      scrollPosition = window.pageYOffset;
      document.body.style.overflow = 'hidden';
      document.body.style.position = 'fixed';
      if (document.body.style.top) {
        document.body.style.top = document.body.style.top;
      } else {
        document.body.style.top = '-' + scrollPosition + 'px';
      }
      document.body.style.width = '100%';
      document.body.style.paddingRight = paddingOffset;
      if (elementsFixed) {
        elementsFixed.forEach(function (item) {
          item.style.marginRight = paddingOffset;
        });
      }
    } else {
      document.body.classList.remove('scroll-disabled');
      scrollPosition = Math.abs(parseInt(document.querySelector('body').style.top.replace('px', '')));
      document.body.style.removeProperty('overflow');
      document.body.style.removeProperty('position');
      document.body.style.removeProperty('top');
      document.body.style.removeProperty('width');
      document.body.style.removeProperty('padding-right');
      if (elementsFixed) {
        elementsFixed.forEach(function (item) {
          item.style.removeProperty('margin-right');
        });
      }
      window.scrollTo({
        top: !isNaN(scrollPosition) ? scrollPosition : 0,
        behavior: 'instant'
      });
    }
  }

  // checker
  var useItemChecker = function useItemChecker(els, onClickOutside) {
    var checkBodyClick = function checkBodyClick(e) {
      var currentEl = e.target;
      while (currentEl) {
        if (els.includes(currentEl)) break;
        currentEl = currentEl.parentNode;
      }
      if (!currentEl) {
        onClickOutside();
        removeBodyChecker();
      }
    };
    function setBodyChecker() {
      document.documentElement.addEventListener('click', checkBodyClick);
    }
    function removeBodyChecker() {
      document.documentElement.removeEventListener('click', checkBodyClick);
    }
    return {
      setBodyChecker: setBodyChecker,
      removeBodyChecker: removeBodyChecker
    };
  };

  // inputmask
  Inputmask().mask(document.querySelectorAll('input'));

  // textarea
  var allTexareas = document.querySelectorAll('textarea');
  if (allTexareas) {
    allTexareas.forEach(function (el) {
      el.style.height = el.setAttribute('style', 'height: ' + el.scrollHeight + 'px');
      el.classList.add('auto');
      el.addEventListener('input', function (e) {
        el.style.height = 'auto';
        el.style.height = el.scrollHeight + 'px';
      });
    });
  }

  // fleet slider
  var fleetSlider = document.querySelector('.fleet__slider .swiper');
  if (fleetSlider) {
    var myFleetSlider = new Swiper(fleetSlider, {
      slidesPerView: 3,
      spaceBetween: 143,
      loop: true,
      centeredSlides: true,
      navigation: {
        prevEl: '.fleet__slider .swiper-button-prev',
        nextEl: '.fleet__slider .swiper-button-next'
      },
      breakpoints: {
        0: {
          slidesPerView: 1,
          spaceBetween: 20
        },
        744: {
          slidesPerView: 3,
          spaceBetween: 60
        },
        1024: {
          slidesPerView: 3,
          spaceBetween: 143
        }
      }
    });
  }

  // directions slider
  var directionsSlider = document.querySelector('.directions__slider .swiper');
  if (directionsSlider) {
    var myDirectionsSlider = new Swiper(directionsSlider, {
      slidesPerView: 1,
      loop: true,
      effect: 'fade',
      fadeEffect: {
        crossFade: true
      },
      speed: 0,
      navigation: {
        prevEl: '.directions__slider .swiper-button-prev',
        nextEl: '.directions__slider .swiper-button-next'
      }
      // on: {
      //     slideChangeTransitionStart: function () {
      //         const activeSlide = document.querySelector('.swiper-slide-active');
      //         const image = activeSlide.querySelector('img');
      //         const text = activeSlide.querySelector('.directions-card__body');

      //         gsap.fromTo(image, { scale: 1.2 }, { scale: 1, duration: 0.8, ease: 'power2.out' });
      //         gsap.fromTo(text, { opacity: 0, y: 20 }, { opacity: 1, y: 0, duration: 0.8, ease: 'power2.out' });
      //     }
      // }
    });
  }
});